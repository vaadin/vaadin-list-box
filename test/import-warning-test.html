<!doctype html>

<head>
  <meta charset="UTF-8">
  <title>vaadin-list-box tests</title>
  <script src="../../../wct-browser-legacy/browser.js"></script>
  <script src="../../../@webcomponents/webcomponentsjs/webcomponents-bundle.js"></script>
  <script type="module" src="../../../@polymer/test-fixture/test-fixture.js"></script>
  <script type="module" src="../../../@polymer/polymer/polymer-legacy.js"></script>
  <script type="module" src="../vaadin-list-box.js"></script>
</head>

<body>
  <test-fixture id="default">
    <template>
      <vaadin-list-box>
        <vaadin-item>Foo</vaadin-item>
        <vaadin-item>Bar</vaadin-item>
      </vaadin-list-box>
    </template>
  </test-fixture>

  <script type="module">
import '@polymer/test-fixture/test-fixture.js';
import { Base } from '@polymer/polymer/polymer-legacy.js';
import '../vaadin-list-box.js';
describe(`import warning for vaadin-item`, () => {
  let listbox;

  function isV2() {
    return window['Polymer'] && window['Polymer']['version'] && window['Polymer']['version'].indexOf('2') === 0;
  }

  beforeEach(() => listbox = fixture('default'));

  it('should warn if not imported', () => {
    sinon.stub(console, 'warn');
    // Emulate setTimeout run from ready
    listbox._checkImport();
    expect(console.warn.callCount).to.equal(1);
    console.warn.restore();
  });

  it('should not warn for present import', (done) => {
    if (isV2()) {
      Base.importHref(`../../vaadin-item/vaadin-item.html`, () => {
        sinon.stub(console, 'warn');
        listbox._checkImport();
        expect(console.warn.called).to.be.false;
        console.warn.restore();
        done();
      });
    } else {
      // importHref is removed in Polymer 3 stable release, skip the test.
      done();
    }
  });
});
</script>
</body>
